zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 7e68015d87d044a89dff23ac469bc703
      template: 'Aruba CX 6000 by SNMP'
      name: 'Aruba CX 6000 by SNMP'
      description: |
        Aruba CX6000 by SNMP
        
        MIBs used:
        ARUBAWIRED-FAN-MIB
        ARUBAWIRED-POWERSUPPLY-MIB
        ARUBAWIRED-SYSTEMINFO-MIB
        ARUBAWIRED-TEMPSENSOR-MIB
        
        based on Aruba CX8300s by SNMP, but with:
        arubaWiredPSUState instead of arubaWiredPSUStateEnum for the power supply status, as it is not present on the CX6000 models.
        
        arubaWiredFanState instead of arubaWiredFanStateEnum for the fan status, as it is not present on the CX6000 models.
        
        no OSPF-MIB 
        no arubaWiredFanRPM
        no arubaWiredPSUInstantaneousPower
        
        tested on "Aruba R8N87A 6000 24G CL4 4SFP"
      readme: |
        ## Overview
        
        The Aruba CX 8300 series is designed for core and aggregation in enterprise campus networks as well as top-of-rack/data center environments. These are high-performance fixed switches offering port speeds from 1 GbE up to 100 GbE, with maximum switching capacity up to 6.4 Tbps.
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 78155c7b63f14a96adcbbb5fbbbc89fb
          name: 'SNMP walk system FAN'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.47196.4.1.1.3.11.5.1]'
          key: aruba.system.fan.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: ARUBAWIRED-FAN-MIB
            Used for discovering system fans.
          tags:
            - tag: component
              value: raw
        - uuid: a1edd2dd6f1d44b59e3c12dc1cb04924
          name: 'SNMP walk system PSU'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.47196.4.1.1.3.11.2.1]'
          key: aruba.system.psu.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: ARUBAWIRED-POWERSUPPLY-MIB
            Used for discovering the system power supply.
          tags:
            - tag: component
              value: raw
        - uuid: 251923ad016e4b6dbcb4c820b2d15249
          name: 'SNMP walk system resource'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1]'
          key: aruba.system.resource.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: ARUBAWIRED-SYSTEMINFO-MIB
            Used for discovering system resources.
          tags:
            - tag: component
              value: raw
        - uuid: 46d55be9f96e450b90d952d68c2eb676
          name: 'SNMP walk system temperature sensor'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.47196.4.1.1.3.11.3.1]'
          key: aruba.system.sensor.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: ARUBAWIRED-TEMPSENSOR-MIB
            Used for discovering system temperature sensors.
          tags:
            - tag: component
              value: raw
        - uuid: efc51b5adeec458497d9bdc68c9b9adf
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          description: |
            The host accessibility by ICMP ping.
            
            0 - ICMP ping fails;
            1 - ICMP ping successful.
          valuemap:
            name: 'Service state'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 493f259b01ab4fe4910c0bd34c488620
              expression: 'max(/Aruba CX 6000 by SNMP/icmpping,#3)=0'
              name: 'Aruba: Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout. Please check device connectivity.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 07b2e329cf404838a82e709b87cd8084
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          value_type: FLOAT
          units: '%'
          description: 'The percentage of lost packets.'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: aee30f6dc6474288850cef8b2dfc5ae3
              expression: 'min(/Aruba CX 6000 by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Aruba CX 6000 by SNMP/icmppingloss,5m)<100'
              name: 'Aruba: High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'ICMP packet loss detected.'
              dependencies:
                - name: 'Aruba: Unavailable by ICMP ping'
                  expression: 'max(/Aruba CX 6000 by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 2f58953213db476d8c2bb4a5a0a61931
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          value_type: FLOAT
          units: s
          description: 'ICMP ping response time (in seconds).'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 35061f84b4634884b0044afb95d447e2
              expression: 'avg(/Aruba CX 6000 by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'Aruba: High ICMP ping response time'
              event_name: 'Aruba: High ICMP ping response time (>{$ICMP_RESPONSE_TIME_WARN}s for 5m)'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: 'Aruba: High ICMP ping loss'
                  expression: 'min(/Aruba CX 6000 by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Aruba CX 6000 by SNMP/icmppingloss,5m)<100'
                - name: 'Aruba: Unavailable by ICMP ping'
                  expression: 'max(/Aruba CX 6000 by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 8b247b83b3594f16a501fc9355c8a7ce
          name: 'SNMP walk network interfaces'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.2.2.1.10,1.3.6.1.2.1.2.2.1.16,1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.20,1.3.6.1.2.1.2.2.1.19,1.3.6.1.2.1.2.2.1.13,1.3.6.1.2.1.2.2.1.5]'
          key: net.if.walk
          history: '0'
          value_type: TEXT
          description: 'Used for discovering interfaces from IF-MIB.'
          tags:
            - tag: component
              value: raw
        - uuid: 5328055f3c144f309fcce0f434422840
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          value_type: LOG
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: component
              value: network
        - uuid: 1c5af0c5c319431c816611e54c9c5179
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.4.0]'
          key: 'system.contact[sysContact.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person. If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: ad3a242db2064646a47c221195eafe17
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: eb9877920547424ca9bd86a4292b0fd2
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.1.1.0]'
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 33cad253a5dd44a89d25410b33b316d0
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.6.0]'
          key: 'system.location[sysLocation.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: c570f7512a7a43f7bd9c23ad0359af46
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.5.0]'
          key: system.name
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name. If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 9252e3401bd347b19a5c229405e42ef4
              expression: 'last(/Aruba CX 6000 by SNMP/system.name,#1)<>last(/Aruba CX 6000 by SNMP/system.name,#2) and length(last(/Aruba CX 6000 by SNMP/system.name))>0'
              name: 'Aruba: System name has changed'
              event_name: 'Aruba: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: 611ebfd6f679492f8998aff0adc79105
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.3.0]'
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 8ca90951aa7d40b780b69ed5a57ea93b
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.2.0]'
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity. This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 5d04bccfc66f4018ae6448c783e75d2e
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 4eb324f40d834d6f8492b0404014bb53
              expression: 'max(/Aruba CX 6000 by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'Aruba: No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'Aruba: Unavailable by ICMP ping'
                  expression: 'max(/Aruba CX 6000 by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: e1c1d0c4547f4967b5c680f670f1c7b2
          name: 'Fan discovery'
          type: DEPENDENT
          key: aruba.fan.discovery
          description: 'Used for discovering fans from ARUBAWIRED-FAN-MIB.'
          item_prototypes:
            - uuid: 2d57e02c814749808f7293e855689cc6
              name: 'Fan [{#SNMPVALUE}]: Status'
              type: DEPENDENT
              key: 'aruba.fan.status[arubaWiredFanStateEnum.{#SNMPINDEX}]'
              value_type: TEXT
              description: |
                MIB: ARUBAWIRED-FAN-MIB
                Current status of the fan.
                Possible values:
                1 - Unknown;
                2 - Empty;
                3 - Uninitialized;
                4 - Ok;
                5 - Fault.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.11.5.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.fan.walk
              tags:
                - tag: component
                  value: fan
                - tag: fan
                  value: '{#SNMPVALUE}'
              trigger_prototypes:
                - uuid: 06bc071fccb04cc8afad65d71931201b
                  expression: 'last(/Aruba CX 6000 by SNMP/aruba.fan.status[arubaWiredFanStateEnum.{#SNMPINDEX}])<>"ok"'
                  name: 'Aruba: Fan [{#SNMPVALUE}]: Status is not "Ok"'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The fan status is not "Ok".'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          master_item:
            key: aruba.system.fan.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.4.1.47196.4.1.1.3.11.5.1.1.4
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 7eb8703057cc41c395703df8ab6fa359
          name: 'PSU discovery'
          type: DEPENDENT
          key: aruba.psu.discovery
          description: 'Used for discovering PSU from ARUBAWIRED-POWERSUPPLY-MIB.'
          item_prototypes:
            - uuid: 1676a17f1544480696cd3817182a3022
              name: 'PSU [{#SNMPVALUE}]: State'
              type: DEPENDENT
              key: 'aruba.psu.state[arubaWiredPSUState.{#SNMPINDEX}]'
              value_type: TEXT
              description: |
                MIB: ARUBAWIRED-POWERSUPPLY-MIB
                Current status for the power supply.
                Possible values:
                1 - Ok;
                2 - Fault Absent;
                3 - Fault Input;
                4 - Fault Output;
                5 - Fault POE;
                6 - Fault No Recov;
                7 - Alert;
                8 - Unknown;
                9 - Unsupported;
                10 - Warning;
                11 - Init;
                12 - Empty;
                13 - Fault Airflow;
                14 - Fault Redundancy.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.11.2.1.1.4.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.psu.walk
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#SNMPVALUE}'
              trigger_prototypes:
                - uuid: b6020113774e459d8ae778cb08403d17
                  expression: 'last(/Aruba CX 6000 by SNMP/aruba.psu.state[arubaWiredPSUState.{#SNMPINDEX}])<>"ok"'
                  name: 'Aruba: PSU [{#SNMPVALUE}]: State is not "Ok"'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The PSU status is not "Ok".'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          master_item:
            key: aruba.system.psu.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.4.1.47196.4.1.1.3.11.2.1.1.3
                - '0'
                - '{#ARUBA.POWER.SUPPLY.MAX.POWER}'
                - 1.3.6.1.4.1.47196.4.1.1.3.11.2.1.1.8
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: d7845de8234542f6aa3e9d12e705590d
          name: 'Resource discovery'
          type: DEPENDENT
          key: aruba.resource.discovery
          description: 'Used for discovering system resources from ARUBAWIRED-SYSTEMINFO-MIB.'
          item_prototypes:
            - uuid: 176eba3d05484246abd6021dea0d4c94
              name: 'Module [{#SNMPVALUE}]: CPU load average 1 min'
              type: DEPENDENT
              key: 'aruba.system.cpu.la1[arubaWiredSystemInfoCpuAvgOneMin.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                The percentage of CPU utilization of the subsystem averaged across all the CPUs of the system over a one-minute period.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 3bd0cbce00124ab5a6f63a78cf30a37b
              name: 'Module [{#SNMPVALUE}]: CPU load average 5 min'
              type: DEPENDENT
              key: 'aruba.system.cpu.la5[arubaWiredSystemInfoCpuAvgFiveMin.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                The percentage of CPU utilization of the subsystem averaged across all the CPUs of the system period of five minutes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.11.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 2c13e686516946fe9787892b0bb82075
              name: 'Module [{#SNMPVALUE}]: CPU utilization'
              type: DEPENDENT
              key: 'aruba.system.cpu.utilization[arubaWiredSystemInfoCpu.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                The percentage of CPU utilization of the subsystem averaged across all the CPUs of the system.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.3.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: cpu
              trigger_prototypes:
                - uuid: 36df57bb82124146b5d088940255520d
                  expression: 'min(/Aruba CX 6000 by SNMP/aruba.system.cpu.utilization[arubaWiredSystemInfoCpu.{#SNMPINDEX}],5m)>{$ARUBA.CPU.UTIL.MAX}'
                  name: 'Aruba: Generic SNMP: Module [{#SNMPVALUE}]: High CPU utilization'
                  event_name: 'Aruba: Generic SNMP: Module [{#SNMPVALUE}]: High CPU utilization (>{$ARUBA.CPU.UTIL.MAX}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The system is running out of free memory.'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
            - uuid: da9efc8e849c409b9d546d2a7bfedd47
              name: 'Module [{#SNMPVALUE}]: Memory usage'
              type: DEPENDENT
              key: 'aruba.system.memory.usage[arubaWiredSystemInfoMemory.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                Subsystem memory usage in percent.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.4.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: memory
              trigger_prototypes:
                - uuid: 438cc2f699c94bd5aeef26194b7eb056
                  expression: 'min(/Aruba CX 6000 by SNMP/aruba.system.memory.usage[arubaWiredSystemInfoMemory.{#SNMPINDEX}],5m)>{$ARUBA.MEMORY.UTIL.MAX}'
                  name: 'Aruba: Generic SNMP: Module [{#SNMPVALUE}]: High memory utilization'
                  event_name: 'Aruba: Generic SNMP: Module [{#SNMPVALUE}]: High memory utilization (>{$ARUBA.MEMORY.UTIL.MAX}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The system is running out of free memory.'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
            - uuid: 60be3058be44472395526f1c7f49eba7
              name: 'Module [{#SNMPVALUE}]: Storage core dump utilization'
              type: DEPENDENT
              key: 'aruba.system.storage.coredump.utilization[arubaWiredSystemInfoStorageCoredump.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                Utilization of core dump storage partition in percent.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.7.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: memory
            - uuid: e1aa4d3e374c4d6fa58ba6c544a98e96
              name: 'Module [{#SNMPVALUE}]: Storage log utilization'
              type: DEPENDENT
              key: 'aruba.system.storage.log.utilization[arubaWiredSystemInfoStorageLog.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                Utilization of log storage partition in percent.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: memory
            - uuid: 2d2db6fa18fc4d8b8abf2356d5f9de55
              name: 'Module [{#SNMPVALUE}]: Storage NOS utilization'
              type: DEPENDENT
              key: 'aruba.system.storage.nos.utilization[arubaWiredSystemInfoStorageNos.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                Utilization of network operating system storage partition in percent.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: memory
            - uuid: c7392b99f8f7458ba8d310978f441c3b
              name: 'Module [{#SNMPVALUE}]: Storage security utilization'
              type: DEPENDENT
              key: 'aruba.system.storage.security.utilization[arubaWiredSystemInfoStorageSecurity.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                Utilization of security storage partition in percent.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.8.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: memory
            - uuid: 61caf0054fcf4c91b7b84d568588a31e
              name: 'Module [{#SNMPVALUE}]: Storage self test utilization'
              type: DEPENDENT
              key: 'aruba.system.storage.selftest.utilization[arubaWiredSystemInfoStorageSelftest.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: ARUBAWIRED-SYSTEMINFO-MIB
                Utilization of self test storage partition in percent.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.9.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.resource.walk
              tags:
                - tag: component
                  value: memory
          graph_prototypes:
            - uuid: 188a0fa614ae452898a782342d991ffd
              name: 'Generic SNMP: Module [{#SNMPVALUE}]: CPU utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'aruba.system.cpu.utilization[arubaWiredSystemInfoCpu.{#SNMPINDEX}]'
            - uuid: 87f29e28a9f040a8823f56f8688d1223
              name: 'Generic SNMP: Module [{#SNMPVALUE}]: Memory utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'aruba.system.memory.usage[arubaWiredSystemInfoMemory.{#SNMPINDEX}]'
          master_item:
            key: aruba.system.resource.walk
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const data = value.split("\n");
                  
                  var base_oid = ".1.3.6.1.4.1.47196.4.1.1.3.22.1.0.1.1.3",
                  	lld_json = [];
                  
                  for (var line in data) {
                  	var index = data[line].indexOf(base_oid);
                  
                  	if (index !== -1) {
                  		var result = [],
                  			oid = data[line].split(' ')[0],
                  			tail = oid.substring(index + base_oid.length + 1),
                  			parts = tail.split('.');
                  
                  		var i = 0;
                  		while (i < parts.length) {
                  			var len = parseInt(parts[i]);
                  			if (isNaN(len) || len < 1 || i + len >= parts.length) {
                  				i++;
                  				continue;
                  			}
                  
                  			var isAscii = true;
                  			for (var j = 0; j < len; j++) {
                  				var val = parseInt(parts[i + 1 + j]);
                  				if (val < 32 || val > 126) {
                  					isAscii = false;
                  					break;
                  				}
                  			}
                  
                  			if (isAscii) {
                  				var str = '';
                  				for (var j = 0; j < len; j++) {
                  					str += String.fromCharCode(parseInt(parts[i + 1 + j]));
                  				}
                  				result.push(str);
                  				i = i + 1 + len;
                  			}
                  			else {
                  				i++;
                  			}
                  		}
                  
                  		lld_json.push({'{#SNMPVALUE}': result.join(" "), '{#SNMPINDEX}': tail});
                  	}
                  }
                  
                  return JSON.stringify(lld_json);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 6e526cc55d0c4335b8e686163ef6d5d8
          name: 'Sensor discovery'
          type: DEPENDENT
          key: aruba.sensor.discovery
          description: 'Used for discovering temperature sensors from ARUBAWIRED-TEMPSENSOR-MIB.'
          item_prototypes:
            - uuid: e6982599d59f4b8ab0a2b8a087903277
              name: 'Sensor [{#SNMPVALUE}]: State'
              type: DEPENDENT
              key: 'aruba.system.sensors[arubaWiredTempSensorState.{#SNMPINDEX}]'
              value_type: CHAR
              description: |
                MIB: ARUBAWIRED-TEMPSENSOR-MIB
                Current status for the temperature sensor.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.11.3.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: aruba.system.sensor.walk
              tags:
                - tag: component
                  value: sensor
                - tag: sensor
                  value: '{#SNMPVALUE}'
              trigger_prototypes:
                - uuid: 942d65204bdd4aa9a46fa55cca34e9f2
                  expression: 'last(/Aruba CX 6000 by SNMP/aruba.system.sensors[arubaWiredTempSensorState.{#SNMPINDEX}])<>"normal"'
                  name: 'Aruba: Sensor [{#SNMPVALUE}]: State is not "normal"'
                  event_name: 'Aruba: Sensor [{#SNMPVALUE}]: State is not "normal": {ITEM.LASTVALUE}'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The current temperature sensor state is not "normal".'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
            - uuid: 19b9bca0c9f34105a29c28cca9b19b92
              name: 'Sensor [{#SNMPVALUE}]: Temperature'
              type: DEPENDENT
              key: 'aruba.system.sensors[arubaWiredTempSensorTemperature.{#SNMPINDEX}]'
              value_type: FLOAT
              units: °C
              description: |
                MIB: ARUBAWIRED-TEMPSENSOR-MIB
                Current temperature value read from the temperature sensor.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.47196.4.1.1.3.11.3.1.1.7.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.system.sensor.walk
              tags:
                - tag: component
                  value: sensor
                - tag: sensor
                  value: '{#SNMPVALUE}'
              trigger_prototypes:
                - uuid: 0b9bd672858f438e80e85fffe9a9adba
                  expression: 'min(/Aruba CX 6000 by SNMP/aruba.system.sensors[arubaWiredTempSensorTemperature.{#SNMPINDEX}],5m)>{#ARUBA.TEMPERATURE.MAX}'
                  name: 'Aruba: Sensor [{#SNMPVALUE}]: High temperature'
                  event_name: 'Aruba: Sensor [{#SNMPVALUE}]: High temperature (>{#ARUBA.TEMPERATURE.MAX} °C)'
                  opdata: 'Current temperature: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The current temperature is greater than the threshold state.'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: 41b69e2233e3458da713be70b4ee6c97
                  expression: 'max(/Aruba CX 6000 by SNMP/aruba.system.sensors[arubaWiredTempSensorTemperature.{#SNMPINDEX}],5m)<{#ARUBA.TEMPERATURE.MIN}'
                  name: 'Aruba: Sensor [{#SNMPVALUE}]: Low temperature'
                  event_name: 'Aruba: Sensor [{#SNMPVALUE}]: Low temperature (<{#ARUBA.TEMPERATURE.MIN} °C)'
                  priority: AVERAGE
                  description: 'The current temperature is less than the threshold state.'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: b0486cd25c044b5c93675ff4a12f75c4
              name: 'Sensor [{#SNMPVALUE}]: Temperature'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'aruba.system.sensors[arubaWiredTempSensorTemperature.{#SNMPINDEX}]'
          master_item:
            key: aruba.system.sensor.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.4.1.47196.4.1.1.3.11.3.1.1.5
                - '0'
                - '{#ARUBA.TEMPERATURE.MAX}'
                - 1.3.6.1.4.1.47196.4.1.1.3.11.3.1.1.9
                - '0'
                - '{#ARUBA.TEMPERATURE.MIN}'
                - 1.3.6.1.4.1.47196.4.1.1.3.11.3.1.1.8
                - '0'
              error_handler: DISCARD_VALUE
            - type: JAVASCRIPT
              parameters:
                - |
                  const json_data = JSON.parse(value);
                  
                  for (var entity in json_data) {
                  	json_data[entity]["{#ARUBA.TEMPERATURE.MIN}"] = json_data[entity]["{#ARUBA.TEMPERATURE.MIN}"]/1000;
                  	json_data[entity]["{#ARUBA.TEMPERATURE.MAX}"] = json_data[entity]["{#ARUBA.TEMPERATURE.MAX}"]/1000;
                  }
                  
                  return JSON.stringify(json_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: cf85062ae6784fb2b1e3d4076ff3a5e6
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: eeb4899e0e2a45c6aa25b39ddd711851
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: DEPENDENT
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 78882ddc8af548c4b773279337b31fae
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: DEPENDENT
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 2cffaa27b83d42c0b23f305ff233ac57
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: DEPENDENT
              key: 'net.if.in[ifInOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface,including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and another times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 2e0a9874e87b45b59bc3a8d4e099c4e0
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: DEPENDENT
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 02f23852d08c4feab790c7c80dd5a6dd
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: DEPENDENT
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: fcbe8702e3ba4261aba3e1379809ed9f
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: DEPENDENT
              key: 'net.if.out[ifOutOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 66125abe897a4e26bc3a61582dd0cd3f
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: DEPENDENT
              key: 'net.if.speed[ifSpeed.{#SNMPINDEX}]'
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in bits per second.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made,
                this object should contain the nominal bandwidth.
                If the bandwidth of the interface is greater than the maximum value reportable by this object then
                this object should report its maximum value (4,294,967,295) and ifHighSpeed must be used to report the interface's speed.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 5m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 9a7c9b99ecdb4954a8fa3bc8b25fa3a5
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: DEPENDENT
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 497d25ca097442cea4c2c1251546c403
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.
                    3. `last(/TEMPLATE_NAME/METRIC,#1)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for "eternal off" interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: aaec4447203349e79a4c278043761f06
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: DEPENDENT
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: 3955e1f72b26446380039f194083220a
              expression: |
                change(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])<0 and last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])>0
                and (
                last(/Aruba CX 6000 by SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/Aruba CX 6000 by SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/Aruba CX 6000 by SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/Aruba CX 6000 by SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/Aruba CX 6000 by SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/Aruba CX 6000 by SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])>0 and last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: a4278630abfc4fac8994825be5ef1c57
              expression: |
                (avg(/Aruba CX 6000 by SNMP/net.if.in[ifInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}]) or
                avg(/Aruba CX 6000 by SNMP/net.if.out[ifOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])) and
                last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Aruba CX 6000 by SNMP/net.if.in[ifInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}]) and
                avg(/Aruba CX 6000 by SNMP/net.if.out[ifOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Aruba CX 6000 by SNMP/net.if.speed[ifSpeed.{#SNMPINDEX}])
              name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: c0069ac8a4534139a9444428176d5922
              expression: |
                min(/Aruba CX 6000 by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Aruba CX 6000 by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Aruba CX 6000 by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Aruba CX 6000 by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'Aruba: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Aruba CX 6000 by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: bb9115e618dc419ea17f5f988c78163d
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'net.if.in[ifInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'net.if.out[ifOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba CX 6000 by SNMP'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
          master_item:
            key: net.if.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFADMINSTATUS}'
                - 1.3.6.1.2.1.2.2.1.7
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#IFTYPE}'
                - 1.3.6.1.2.1.2.2.1.3
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: network
        - tag: target
          value: aruba
        - tag: target
          value: cx6000
      macros:
        - macro: '{$ARUBA.CPU.UTIL.MAX}'
          value: '90'
          description: 'Threshold of CPU utilization expressed in %.'
          config:
            type: TEXT
            priority: '3'
            section_name: Thresholds
            label: 'Threshold for CPU utilization'
            description: 'In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ARUBA.MEMORY.UTIL.MAX}'
          value: '90'
          description: 'Threshold of memory utilization expressed in %.'
          config:
            type: TEXT
            priority: '2'
            section_name: Thresholds
            label: 'Threshold for memory utilization'
            description: 'In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ARUBA.POWER.SUPPLY.THR.MAX}'
          value: '90'
          description: 'Threshold of power utilization expressed in %.'
          config:
            type: TEXT
            priority: '1'
            section_name: Thresholds
            label: 'Threshold for power utilization'
            description: 'In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
          config:
            type: TEXT
            priority: '4'
            section_name: Thresholds
            label: 'Threshold of ICMP packet loss'
            description: 'Warning threshold of ICMP packet loss in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of average ICMP response time in seconds.'
          config:
            type: TEXT
            priority: '5'
            section_name: Thresholds
            label: 'Threshold of the average ICMP response'
            description: 'Warning threshold of the average ICMP response time in seconds. No less than 0.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Warning threshold of error packet rate. Can be used with interface name as context.'
        - macro: '{$IF.UTIL.MAX}'
          value: '95'
        - macro: '{$IFCONTROL}'
          value: '1'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
          config:
            type: TEXT
            priority: '6'
            section_name: Other
            label: 'Time interval'
            description: 'Time interval for the SNMP availability trigger.'
      dashboards:
        - uuid: 2f68ff55ae06437faf9b4220b4af8c5f
          name: 'Aruba: Overview'
          pages:
            - name: 'Aruba: Overview'
              widgets:
                - type: item
                  name: 'Uptime (network)'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba CX 6000 by SNMP'
                        key: 'system.net.uptime[sysUpTime.0]'
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: svggraph
                  name: 'ICMP response time'
                  'y': '2'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Aruba CX 6000 by SNMP'
                        key: icmppingsec
                    - type: INTEGER
                      name: ds.0.width
                      value: '3'
                    - type: INTEGER
                      name: legend_columns
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAA
                - type: honeycomb
                  name: 'Sensor temperature'
                  'y': '7'
                  width: '24'
                  height: '5'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Sensor*Temperature'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("Sensor\s\[(.*)\]","\1")}'
                    - type: STRING
                      name: reference
                      value: AAAAD
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                - type: item
                  name: 'System name'
                  x: '18'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba CX 6000 by SNMP'
                        key: system.name
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: svggraph
                  name: 'CPU utilization'
                  x: '24'
                  'y': '7'
                  width: '24'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: ds.0.color_palette
                      value: '0'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: '*CPU utilization'
                    - type: INTEGER
                      name: ds.0.width
                      value: '3'
                    - type: STRING
                      name: lefty_max
                      value: '100'
                    - type: STRING
                      name: lefty_min
                      value: '0'
                    - type: STRING
                      name: lefty_static_units
                      value: '%'
                    - type: INTEGER
                      name: lefty_units
                      value: '1'
                    - type: INTEGER
                      name: legend_columns
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAE
                - type: item
                  name: 'System location'
                  x: '36'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba CX 6000 by SNMP'
                        key: 'system.location[sysLocation.0]'
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: honeycomb
                  name: 'Fan status'
                  x: '36'
                  'y': '2'
                  width: '24'
                  height: '5'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Fan*status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("Fan\s\[(.*)\]","\1")}'
                    - type: STRING
                      name: reference
                      value: AAAAB
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: B0BEC5
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: B0BEC5
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF8000
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
                    - type: STRING
                      name: thresholds.3.color
                      value: AED581
                    - type: STRING
                      name: thresholds.3.threshold
                      value: '4'
                    - type: STRING
                      name: thresholds.4.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.4.threshold
                      value: '5'
                - type: svggraph
                  name: 'Memory usage'
                  x: '48'
                  'y': '7'
                  width: '24'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: ds.0.color_palette
                      value: '0'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: '*Memory usage'
                    - type: INTEGER
                      name: ds.0.width
                      value: '3'
                    - type: STRING
                      name: lefty_max
                      value: '100'
                    - type: STRING
                      name: lefty_min
                      value: '0'
                    - type: STRING
                      name: lefty_static_units
                      value: '%'
                    - type: INTEGER
                      name: lefty_units
                      value: '1'
                    - type: INTEGER
                      name: legend_columns
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAF
                - type: item
                  name: 'System description'
                  x: '54'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba CX 6000 by SNMP'
                        key: 'system.descr[sysDescr.0]'
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: honeycomb
                  name: 'PSU state'
                  x: '60'
                  'y': '2'
                  width: '12'
                  height: '5'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'PSU*State'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("PSU\s\[(.*)\]","\1")}'
                    - type: STRING
                      name: reference
                      value: AAAAC
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: AED581
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
                    - type: STRING
                      name: thresholds.3.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.3.threshold
                      value: '4'
                    - type: STRING
                      name: thresholds.4.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.4.threshold
                      value: '5'
                    - type: STRING
                      name: thresholds.5.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.5.threshold
                      value: '6'
                    - type: STRING
                      name: thresholds.6.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.6.threshold
                      value: '7'
                    - type: STRING
                      name: thresholds.7.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.7.threshold
                      value: '8'
                    - type: STRING
                      name: thresholds.8.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.8.threshold
                      value: '9'
                    - type: STRING
                      name: thresholds.9.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.9.threshold
                      value: '10'
                    - type: STRING
                      name: thresholds.10.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.10.threshold
                      value: '11'
                    - type: STRING
                      name: thresholds.11.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.11.threshold
                      value: '12'
                    - type: STRING
                      name: thresholds.12.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.12.threshold
                      value: '13'
                    - type: STRING
                      name: thresholds.13.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.13.threshold
                      value: '14'
      valuemaps:
        - uuid: 40e1af51b03341ad8598e55cfa4ecb6b
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: 252705357d194e8089fdaeaabb5540ac
          name: 'IF-MIB::ifType'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: 3a32ad1abb2c4d9aabfa5e19b1a21e11
          name: 'Power supply state'
          mappings:
            - value: '1'
              newvalue: Ok
            - value: '2'
              newvalue: 'Fault Absent'
            - value: '3'
              newvalue: 'Fault Input'
            - value: '4'
              newvalue: 'Fault Output'
            - value: '5'
              newvalue: 'Fault POE'
            - value: '6'
              newvalue: 'Fault No Recov'
            - value: '7'
              newvalue: Alert
            - value: '8'
              newvalue: Unknown
            - value: '9'
              newvalue: Unsupported
            - value: '10'
              newvalue: Warning
            - value: '11'
              newvalue: Init
            - value: '12'
              newvalue: Empty
            - value: '13'
              newvalue: 'Fault Airflow'
            - value: '14'
              newvalue: 'Fault Redundancy'
        - uuid: 79b791230d2745e9a629281324605014
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: 7bc50f6b0531436ab7825566eb23c188
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 463b098172d7447da84c988cf8e4bff6
      expression: '(last(/Aruba CX 6000 by SNMP/system.hw.uptime[hrSystemUptime.0])>0 and last(/Aruba CX 6000 by SNMP/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/Aruba CX 6000 by SNMP/system.hw.uptime[hrSystemUptime.0])=0 and last(/Aruba CX 6000 by SNMP/system.net.uptime[sysUpTime.0])<10m)'
      name: 'Aruba: Host has been restarted'
      event_name: 'Aruba: {HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        - name: 'Aruba: No SNMP data collection'
          expression: 'max(/Aruba CX 6000 by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        - tag: scope
          value: notice
